<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
	<meta http-equiv="content-type" content="text/html;charset=UTF-8" />
	<title><%= controller.controller_name %>: <%= controller.action_name %></title>
	<%= stylesheet_link_tag 'application' %>
	<%= javascript_include_tag :defaults %>
</head>
<body>
	<div id="container">
		<div id="headerbar">
			<%= image_tag 'logo.gif' %>
		</div>

		<% if current_user %>
		<div id="menu">
			<%= link_to 'Patients', patients_path %> |
			<%= link_to 'Samples', samples_url %> |
			<%= link_to 'Experiments', experiments_path %> |
			<%= link_to 'Cohorts', patient_cohorts_path %> |
			<%= link_to 'Administration', admin_path %> | 
			<%= link_to 'Logout', logout_path %>
		</div>
		<% end %>

		<div id="main">

			<% unless @patient.nil? || @patient.new_record? -%>
			<div id="sidebar">
				<div style="background: silver; margin-bottom: 0.8em;">
					Patient Outline
				</div>
				<div id="tree" style="background: #E8F1D4">
					<ul>
						<li class="patient"><%= render :partial => '/layouts/patient_hierarchy' %></li>
					</ul>
				</div>
			</div>
			<div id="content" class="content-with-sidebar">
			<% else %>
			<div id="content">
				<% end %>

				<div id="flash">
					<% if flash[:notice] %><p class="notice"><%= flash[:notice] %></p><% end %>
					<% if flash[:error] %><p class="error"><%= flash[:error] %></p><% end %>
				</div>

				<%= yield  %>
			</div>

		</div>
		<div id="footerbar">

		</div>
	</div>

	<% if ENV['RAILS_ENV'] == 'development' %>
	<div id="debug" style="margin: 40px 5px 5px 5px;">
		<a href="#" onclick="Element.toggle('debug_info');return false" style="text-decoration: none; color: #ccc;">
			Show Debug Info &#10162;
		</a>
		<div id="debug_info" style="display: none;">
			<%= debug session %>
			<%= debug params %>
		</div>
	</div>
	<div id="javascript-debug" style="margin: 5px 5px 5px 5px;">
		<a href="#" onclick="Element.toggle('javascript_debug_info');return false" style="text-decoration: none; color: #ccc;">
			Show JavaScript Debug Info &#10162;
		</a>
		<div id="javascript_debug_info" style="display: none;">
		</div>
	</div>

	<% if ActionView::Base.debug_rjs %> 
	<script type="text/javascript"> 
	Ajax.Responders.register({ 
		onComplete: function(request, transport) { 
			new Insertion.Bottom('javascript_debug_info', 
			'<div style="border: 1px solid">' + 
			'<pre>' + transport.responseText.escapeHTML() + '</pre>' + 
			'</div>') 
		} 
	}); 
	</script> 
	<% end %>
	<% end %>

</body>
</html>
