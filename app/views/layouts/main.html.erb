<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <meta http-equiv="content-type" content="text/html;charset=UTF-8" />
  <title>University of Alberta Bovine LIMS - <%= controller.controller_name %>: <%= controller.action_name %></title>

  <%= stylesheet_link_tag 'yui' %>
  <%= stylesheet_link_tag 'menu' %>
  <%= stylesheet_link_tag 'application' %>
  <%= stylesheet_link_tag 'tree' %>

  <%= javascript_include_tag 'yahoo-dom-event' %>
  <%= javascript_include_tag 'container_core' %>
  <%= javascript_include_tag 'menu' %>
  <%= javascript_include_tag 'tree' %>
	
	<!-- Include YUI patches to fix scrolling issue -->
  <%= javascript_include_tag 'overlay_patch', 'menu_patch' %>

  <%= javascript_include_tag :defaults %>

  <script type="text/javascript">
  // Initialize and render the MenuBar when its elements are ready to be scripted.
  YAHOO.util.Event.onContentReady("navbar", function () {
    var oMenuBar = new YAHOO.widget.MenuBar("navbar", { autosubmenudisplay: true, hidedelay: 650, lazyload: true });
    oMenuBar.render();
  });
  </script>
</head>
<body class="yui-skin-sam">
  <% sidebar = !@test_subject.nil? && !@test_subject.new_record? %>

  <div id="doc3" <%= 'class="yui-t3"' if sidebar %>> 
    <div id="hd"><!-- header -->

      <div id="headerbar">

        <div id="headerbar-right">
          <% if current_user %>
          <div id="logged-in">Logged in as <em><%= current_user.login %></em> | <%= link_to 'Logout', logout_path %></div>

          <% form_tag search_metabolites_path, :style => 'margin: 0em; padding: 0em;' do %>
            Quick Search: <%= text_field_tag 'query', nil, :value => params[:query] %>
            <%= submit_tag 'Go' %>
          <% end %>
          <% end %>
          <div id="version">Version <%= APPLICATION_VERSION %></div>
        </div>
        <%= image_tag 'logo.png', :style => 'float: left; margin-right: 2em;' %>
      </div>

      <% if current_user %>
      <div id="navbar" class="yuimenubar yuimenubarnav">
        <div class="bd">
          <ul class="first-of-type">
            <li class="yuimenubaritem first-of-type">
              <%= link_to 'Home', root_path, :class => 'yuimenubaritemlabel' %>
            </li>
            <li class="yuimenubaritem">
              <%= link_to TestSubject.title.pluralize, test_subjects_path, :class => 'yuimenubaritemlabel' %>
            </li>
            <li class="yuimenubaritem">
              <%= link_to 'Samples', samples_path, :class => 'yuimenubaritemlabel' %>
            </li>
            <li class="yuimenubaritem">
              <%= link_to 'Experiments', experiments_path, :class => 'yuimenubaritemlabel' %>
            </li>
            <li class="yuimenubaritem">
              <%= link_to 'Metabolites', metabolites_path, :class => 'yuimenubaritemlabel' %>
            </li>
            
            <li class="yuimenubaritem">
              <%= link_to 'Feeding', diets_path, :class => 'yuimenubaritemlabel' %>
              <div id="feeding" class="yuimenu">
                <div class="bd">                    
                  <ul>
                    <li class="yuimenuitem"><%= link_to 'Diets', diets_path, :class => 'yuimenuitemlabel' %></li>
										<li class="yuimenuitem"><%= link_to 'Ingredients', ingredients_path, :class => 'yuimenuitemlabel' %></li>
										<li class="yuimenuitem"><%= link_to 'Nutrients', nutrients_path, :class => 'yuimenuitemlabel' %></li>
                  </ul>
                </div>
              </div>                    
            </li>
            
            
            <li class="yuimenubaritem"><%= link_to 'Cohorts', test_subject_cohorts_path, :class => 'yuimenubaritemlabel' %>
              <div id="cohorts" class="yuimenu">
                <div class="bd">                    
                  <ul>
                    <li class="yuimenuitem"><%= link_to "#{TestSubject.title} Cohorts", test_subject_cohorts_path, :class => 'yuimenuitemlabel' %></li>
                    <li class="yuimenuitem"><%= link_to 'Sample Cohorts', sample_cohorts_path, :class => 'yuimenuitemlabel' %></li>
                    <li class="yuimenuitem"><%= link_to 'Experiment Cohorts', experiment_cohorts_path, :class => 'yuimenuitemlabel' %></li>
                  </ul>                    
                </div>
              </div>                                        
            </li>
            <li class="yuimenubaritem">
              <%= link_to 'Data Files', data_files_path, :class => 'yuimenubaritemlabel' %>
            </li>
            <li class="yuimenubaritem"><%= link_to 'Planning', tasks_path, :class => 'yuimenubaritemlabel' %>
              <div id="tasks" class="yuimenu">
                <div class="bd">                    
                  <ul>
                    <li class="yuimenuitem"><%= link_to 'Tasks', tasks_path, :class => 'yuimenuitemlabel' %></li>
                    <li class="yuimenuitem"><%= link_to 'My Tasks', user_tasks_path(current_user), :class => 'yuimenuitemlabel' %></li>
                    <li class="yuimenuitem"><%= link_to 'Gantt Chart', gantt_tasks_path, :class => 'yuimenuitemlabel' %></li>
                    <li class="yuimenuitem"><%= link_to 'Calendar', calendar_tasks_path, :class => 'yuimenuitemlabel' %></li>
                  </ul>                    
                </div>
              </div>                                        
            </li>
            <li class="yuimenubaritem"><a class="yuimenubaritemlabel" href="#tools">Tools</a>
              <div id="tools" class="yuimenu">
                <div class="bd">                    
                  <ul>
                    <li class="yuimenuitem"><%= link_to 'HMDB', 'http://www.hmdb.ca/', :target => '_blank', :class => 'yuimenuitemlabel' %></li>
                    <li class="yuimenuitem"><%= link_to 'DrugBank', 'http://drugbank.ca', :target => '_blank', :class => 'yuimenuitemlabel' %></li>
                    <li class="yuimenuitem"><%= link_to 'Metabo-Analyst', 'http://www.metaboanalyst.ca', :target => '_blank', :class => 'yuimenuitemlabel' %></li>
                  </ul>                    
                </div>
              </div>                                        
            </li>
            <li class="yuimenubaritem">
              <%= link_to 'Administration', admin_path, :class => 'yuimenubaritemlabel' %>
              <div id="administration" class="yuimenu">
                <div class="bd">                    
                  <ul>
                    <li class="yuimenuitem"><%= link_to 'Sites', sites_path, :class => 'yuimenuitemlabel' %></li>
                    <li class="yuimenuitem"><%= link_to 'Data file types', data_file_types_path, :class => 'yuimenuitemlabel' %></li>
                    <li class="yuimenuitem"><%= link_to 'Users', users_path, :class => 'yuimenuitemlabel' %></li>
                    <li class="yuimenuitem"><%= link_to 'Protocols', protocols_path, :class => 'yuimenuitemlabel' %></li>
                  </ul>
                </div>
              </div>                    
            </li>
          </ul> 
        </div>
      </div>
      <% end %>

    </div>  

    <div id="bd"><!-- body -->

      <div class="yui-b"><!-- Navigation block -->
        <% if sidebar -%>
        <div id="sidebar">
          <h2><%= TestSubject.title %> Summary</h2>
          <%= test_subject_tree(@test_subject) %>
        </div>
        <% end %>
      </div>

      <div id="yui-main"><!-- Main content block -->
        <div class="yui-b">
          <div id="main">
            <div id="flash">
              <% if flash[:notice] %><p class="notice"><%= flash[:notice] %></p><% end %>
              <% if flash[:error] %><p class="error"><%= flash[:error] %></p><% end %>
            </div>

            <%= yield  %>
          </div>

        </div> 
      </div> 
    </div>  

    <div id="ft"><!-- footer -->


    </div>  
  </div>

</body>
</html>
